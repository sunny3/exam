# exam
Нейросеть, классифицирующая белки

Функции:

read_ontology - читает генную антологию в формате {id класса:{название класса, принадлежность к цепи, потомки, родители, описание гена}}
def_ignore_classes - определяет классы, которую нужно игнорировать. Частота встреаемости упоминания класса в файле с протпиновыми последовательностями должна быть выше 5.
reduce_data - сокращает объем данных, усекает кол-во протеиновы последовательностей в датасете.
reduce_go - выкидывает игнорируемые классы из датасета
def_mf_branh - выделяет цепь mf из датасета, создает объект {{буквенная последовательность} - {вектор из 0 и 1 классов}}
vectorize_sequences - векторизует последовательности из букв с помощью триграмм
save_data - записывает векторизованные данные в два файла
load_data - загружает векторизованные данные из двух файлов

Модель 
1) Embedding - Слой изучающий кодирование индексов триграмм. Каждому индексу сопостовляет вектор из 128 чисел
2) Conv1D - Слой сворачивающий триграммы, 128 чисел -> 32 - это сверточная часть.
3) MaxPooling1D - Рамка длинной 32 (шаг тоже 32) бегает по всем индексам. среди всех 32 индексов в одном шаге выбирается индекс с наиболее репрезентативной информацией, которую содержат его 32 цифры сверточной части. Т. е. выбирается наиболее важный индекс.
4) Dense - Обычный слой с нейронами
5) Flatten - Слой, который просто вырождает двумерный массив в одномерный без каких-либо его математических преобразований 
6) Dense с activation - Слой который выдает для каждой последовательности вектор вида {0.21, 0.1, 0.78, 0.49 ...} - вероятность принадлежности к классу. Название класса однозначно определяется по порядку вероятности в векторе. Т.е. 0.21 - имеет 0-ой индекс, что соответствует 0-классу. То есть вероятность того, что последовательность принаделжит 0-классу - 21%.

Далее идет округление выходного вектора по вероятностям. Порог 0.6, определен мной экспериментально. Для него точность наибольшая.

На выходе получаем бинарный вектор {0, 0, 1, 0 ...} - последовательность принадлежит 2-классу.

Точность
Взвешенная f1_score дает результат 98% 
